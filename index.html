<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Morro da Mesa</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

<style>
body{margin:0;background:#0f0f0f;font-family:Poppins,sans-serif;color:#fff}
.container{max-width:480px;margin:auto;padding:15px}
.card{background:#1c1c1c;border-radius:22px;padding:18px}
.banner img{width:100%;border-radius:18px;margin-bottom:15px}
label{margin-top:12px;display:block;font-weight:600}
select,input{width:100%;padding:14px;border-radius:14px;border:none;background:#2a2a2a;color:#fff}
.contador{display:flex;justify-content:space-between;align-items:center}
.contador button{width:46px;height:46px;border:none;border-radius:14px;background:#333;color:#fff;font-size:22px}
.info{text-align:center;color:#ccc;margin-top:10px}
.total{font-size:24px;font-weight:700;text-align:center;margin-top:10px;color:#00ff88}
.btn{width:100%;margin-top:14px;padding:18px;border-radius:40px;border:none;font-size:18px;font-weight:700;color:#fff}
.pix{background:#00c96b}
.whats{background:#25d366;display:none}
.aviso{display:none;margin-top:12px;padding:12px;background:#2b1f00;color:#ffcc00;border-radius:14px;text-align:center}
.esgotado{display:none;margin-top:12px;padding:14px;background:#550000;border-radius:14px;text-align:center}
</style>

<script>
const PIX = "trilheiros.roomt@gmail.com";
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxlVHhoiv_SDSukrAMpkBWpoUmjSn8aEa1ksEGrrH0/exec";

/* ğŸ”´ TESTE â€” SOMENTE 1 VAGA */
let vagasOnibus = localStorage.getItem("vagasOnibus") ? parseInt(localStorage.getItem("vagasOnibus")) : 1;
let vagasCarro = localStorage.getItem("vagasCarro") ? parseInt(localStorage.getItem("vagasCarro")) : 1;

let qtd = 1;

function atualizar(){
  const tipo = tipoTransporte.value;
  const valor = tipo === "onibus" ? 85 : 25;

  total.innerText = "ğŸ’° Total: R$ " + (valor * qtd);

  infoVagas.innerText =
    tipo === "onibus"
    ? "ğŸšŒ Vagas restantes: " + vagasOnibus
    : "ğŸš— Vagas restantes: " + vagasCarro;

  if((tipo==="onibus" && vagasOnibus<=0) || (tipo==="carro" && vagasCarro<=0)){
    esgotado.style.display="block";
    btnReservar.disabled=true;
  } else {
    esgotado.style.display="none";
    btnReservar.disabled=false;
  }
}

function mais(){qtd++;quantidade.innerText=qtd;atualizar()}
function menos(){if(qtd>1){qtd--;quantidade.innerText=qtd;atualizar()}}

function salvarNaPlanilha(nome, transporte, quantidade, pagamento, valor){
  fetch(SCRIPT_URL,{
    method:"POST",
    body:JSON.stringify({nome,transporte,quantidade,pagamento,valor})
  });
}

function reservar(){
  const nome = document.getElementById("nome").value;
  const tipo = tipoTransporte.value;
  const pagamento = formaPagamento.value;

  if(!nome) return alert("Digite seu nome");

  if(tipo==="carro" && pagamento==="cartao")
    return alert("Carro prÃ³prio aceita apenas PIX");

  if(tipo==="onibus" && pagamento==="cartao" && qtd>1)
    return alert("Mais de uma vaga no cartÃ£o, fale com o Jonatas");

  if(tipo==="onibus" && qtd>vagasOnibus) return alert("Sem vagas disponÃ­veis");
  if(tipo==="carro" && qtd>vagasCarro) return alert("Sem vagas disponÃ­veis");

  if(tipo==="onibus"){
    vagasOnibus -= qtd;
    localStorage.setItem("vagasOnibus",vagasOnibus);
  }else{
    vagasCarro -= qtd;
    localStorage.setItem("vagasCarro",vagasCarro);
  }

  const valor = (tipo==="onibus"?85:25)*qtd;

  salvarNaPlanilha(
    nome,
    tipo==="onibus"?"Ã”nibus":"Carro prÃ³prio",
    qtd,
    pagamento,
    valor
  );

  navigator.clipboard.writeText(PIX);
  aviso.style.display="block";
  btnWhats.style.display="block";

  atualizar();
}

function enviarWhats(){
  const nome=document.getElementById("nome").value;
  const tipo=tipoTransporte.value==="onibus"?"Ã”nibus":"Carro prÃ³prio";
  const valor=(tipo==="Ã”nibus"?85:25)*qtd;

  const msg=`OlÃ¡! ğŸ‘‹
Segue o comprovante da Trilha do Morro da Mesa ğŸŒ„

ğŸ‘¤ Nome: ${nome}
ğŸš¶ Modalidade: ${tipo}
ğŸ‘¥ Vagas: ${qtd}
ğŸ’° Valor: R$ ${valor}`;

  window.open("https://wa.me/5566996926174?text="+encodeURIComponent(msg));
}
</script>
</head>

<body>
<div class="container">
<div class="card">

<div class="banner">
<img src="https://i.postimg.cc/FzLnkVc2/Orange-and-Black-Modern-Mountain-Bike-Event-Instagram-Post.png">
</div>

<label>Nome completo</label>
<input id="nome">

<label>Tipo de transporte</label>
<select id="tipoTransporte" onchange="atualizar()">
  <option value="onibus">ğŸšŒ Ã”nibus â€“ R$ 85</option>
  <option value="carro">ğŸš— Carro prÃ³prio â€“ R$ 25</option>
</select>

<label>Quantidade</label>
<div class="contador">
<button onclick="menos()">âˆ’</button>
<span id="quantidade">1</span>
<button onclick="mais()">+</button>
</div>

<div id="infoVagas" class="info"></div>
<div id="total" class="total"></div>

<label>Forma de pagamento</label>
<select id="formaPagamento">
  <option value="pix">ğŸ’š PIX</option>
  <option value="cartao">ğŸ’³ CartÃ£o (Ã´nibus)</option>
</select>

<div id="aviso" class="aviso">
ğŸ“¢ ApÃ³s o pagamento, envie o comprovante no WhatsApp para garantir sua vaga.
</div>

<button id="btnReservar" class="btn pix" onclick="reservar()">CONFIRMAR PAGAMENTO</button>

<div id="esgotado" class="esgotado">âŒ VAGAS ESGOTADAS</div>

<button id="btnWhats" class="btn whats" onclick="enviarWhats()">ENVIAR COMPROVANTE</button>

</div>
</div>

<script>atualizar();</script>
</body>
</html>

